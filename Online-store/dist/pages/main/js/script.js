(()=>{"use strict";let t=document.getElementById("products__search"),e=document.getElementsByClassName("item-title");function n(t){return t.toLowerCase().replace(/\s/g,"").trim()}function a(t,e){t.parentElement.style.display=e}function o(t){t&&Array.from(e).filter((e=>{n(e.innerHTML).includes(t)?a(e,"flex"):a(e,"none")}))}t.oninput=function(){let t=document.getElementById("products__search").value;console.log(t),t&&o(n(t)),t||location.reload()};const i=o,r=document.getElementById("products__droplist-asc"),l=document.getElementById("products__droplist-desc"),c=document.getElementById("products__droplist");let s=document.getElementById("products-list");function d(t){let e=document.createElement("div");e.className="product",e.id=`product-item-${t.id}`,e.dataset.sort=`${t.price}`,e.dataset.brand=`${t.brand}`,e.dataset.category=`${t.category}`,e.innerHTML=`\n  <div id="element1" class="element"\n  style="background: url(${t.thumbnail}) no-repeat left; background-size: auto; dispaly: block;">\n  <div class="item-title">${t.title}</div>\n  <div class="element-info">\n    <ul class="info-list">\n      <li class="info-list__item"><span>Category: </span> ${t.category}</li>\n      <li class="info-list__item"><span>Brand</span>: ${t.brand}</li>\n      <li class="info-list__item"><span>Price</span>: ${t.price}ÔºÑ</li>\n      <li class="info-list__item"><span>Discount</span>: ${t.discountPercentage}%</li>\n      <li class="info-list__item"><span>Rating</span>: ${t.rating}‚≠êÔ∏è</li>\n      <li class="info-list__item"><span>Stock</span>: ${t.stock}üõç</li>\n    </ul>\n  </div>\n  <div class="item-buttons">\n    <button class="item-buttons__add" id=product-add-${t.id}>Add to cart</button>\n    <button class="item-buttons__details" id=product-details-${t.id}>Details</button>\n  </div>\n</div>`,s.appendChild(e)}function u(t,e,n){t.classList.add(e),t.textContent=n}const m=function(t,e,n,a){const o=document.querySelector(t),i=document.querySelector(n),r=JSON.parse(localStorage.getItem("RS-online-cart"));o.textContent=e+r.reduce(((t,e)=>t+e.count),0),i.textContent=a+r.reduce(((t,e)=>t+e.count*e.price),0)};function f(t,e){return t.reduce(((t,n)=>t.includes(n.getAttribute(e).toLowerCase())?t:[...t,n.getAttribute(e).toLowerCase()]),[])}function p(t){const e=Array.from(document.querySelectorAll(".product"));let n=document.getElementById("filter-brand"),a=document.getElementById("filter-category"),o=document.createElement("div");o.className="filter__list-item",o.innerHTML=`\n  <div class="filter-list-item" data-filter="${t}">\n  <div>\n    <label>\n      <input class="filter-list-item__checkbox" type="checkbox">\n      ${t}\n    </label>\n  </div>\n</div>`,f(e,"data-brand").includes(t)&&n.appendChild(o),f(e,"data-category").includes(t)&&a.appendChild(o)}function g(t){for(let e in t)p(t[e])}const y=document.getElementsByClassName("product");let _=[];function v(t,e){return t.style.display=e}function b(t,e){return _.includes(t.getAttribute(e).toLowerCase())}const S=function(){const t=document.querySelectorAll(".filter-list-item");Array.from(t).map((t=>{t.addEventListener("change",(e=>{e&&(function(t,e){_.includes(e.getAttribute("data-filter"))?_.splice(_.indexOf(e.getAttribute("data-filter")),1):t&&_.push(e.getAttribute("data-filter")),console.log(_)}(e,t),_.length>=2?_.length?Array.from(y).map((t=>{b(t,"data-brand")&&b(t,"data-category")?v(t,"flex"):v(t,"none")})):Array.from(y).map((t=>{v(t,"flex")})):_.length?Array.from(y).map((t=>{b(t,"data-brand")||b(t,"data-category")?v(t,"flex"):v(t,"none")})):Array.from(y).map((t=>{v(t,"flex")})),function(){let t=document.getElementsByClassName("product"),e=document.getElementById("products__total-find"),n=0;Array.from(t).forEach((t=>{"flex"===t.style.display&&++n})),e.innerText=`Results: ${n}`}())}))}))};let h,C=document.getElementById("products-list");localStorage.getItem("RS-online-cart")||localStorage.setItem("RS-online-cart",JSON.stringify([])),async function(){let t=await fetch("https://dummyjson.com/products"),e=(await t.json()).products;for(let t in e)await d(e[t]);return e}().then((t=>{h=JSON.parse(JSON.stringify(t)),JSON.parse(localStorage.getItem("RS-online-cart")).forEach((t=>{if(h.find((e=>e.id===t.id))){const e=h.find((e=>e.id===t.id));u(document.querySelector(`#product-add-${e.id}`),"button-add__active","Remove from cart")}}));const e=Array.from(document.querySelectorAll(".product"));m(".header__cart span","",".header__total","Cart total:ÔºÑ"),i(),function(t,e){t.addEventListener("click",(t=>{const n=+t.target.id.split("-")[2];let a=JSON.parse(localStorage.getItem("RS-online-cart"));if(t.target.classList.contains("item-buttons__details")&&(window.location.href=function(t){const e=new URLSearchParams({id:t}),n=window.location.pathname.replace("main","about");return window.location.origin+n+"?"+e.toString()}(n)),t.target.classList.contains("button-add__active"))a=a.filter((t=>t.id!==n)),(o=t.target).classList.remove("button-add__active"),o.textContent="Add to cart";else if(t.target.classList.contains("item-buttons__add")){const o=e.find((t=>t.id===n)),i={id:o.id,price:o.price,count:1};a.push(i),u(t.target,"button-add__active","Remove from cart")}var o;localStorage.setItem("RS-online-cart",JSON.stringify(a)),m(".header__cart span","",".header__total","Cart total:ÔºÑ")}))}(C,h),function(){function t(t,e){return[parseInt(t.value,10),parseInt(e.value,10)]}function e(t,e,n,a,o){const i=e.max-e.min,r=t.value-e.min,l=e.value-e.min;o.style.background=`linear-gradient(\n    to right,\n    ${n} 0%,\n    ${n} ${r/i*100}%,\n    ${a} ${r/i*100}%,\n    ${a} ${l/i*100}%, \n    ${n} ${l/i*100}%, \n    ${n} 100%)`}function n(t){const e=document.querySelector("#toSlider");Number(t.value)<=0?e.style.zIndex=2:e.style.zIndex=0}const a=document.querySelector("#fromSlider"),o=document.querySelector("#toSlider"),i=document.querySelector("#fromInput"),r=document.querySelector("#toInput");e(a,o,"#C6C6C6","#25daa5",o),n(o),a.oninput=()=>function(n,a,o){const[i,r]=t(n,a);e(n,a,"#C6C6C6","#25daa5",a),i>r?(n.value=r,o.value=r):o.value=i}(a,o,i),o.oninput=()=>function(a,o,i){const[r,l]=t(a,o);e(a,o,"#C6C6C6","#25daa5",o),n(o),r<=l?(o.value=l,i.value=l):(i.value=r,o.value=r)}(a,o,r),i.oninput=()=>function(n,a,o,i){const[r,l]=t(a,o);e(a,o,"#C6C6C6","#25daa5",i),r>l?(n.value=l,a.value=l):n.value=r}(a,i,r,o),r.oninput=()=>function(a,o,i,r){const[l,c]=t(o,i);e(o,i,"#C6C6C6","#25daa5",r),n(i),l<=c?(a.value=c,i.value=c):i.value=l}(o,i,r,o)}(),function(){const t=document.getElementById("products-list");c.addEventListener("change",(function(){let e=this.options[this.selectedIndex].text;e===r.text&&function(t){Array.from(t.children).sort(((e,n)=>+e.getAttribute("data-sort")>n.getAttribute("data-sort")?t.insertBefore(e,n):-1))}(t),e===l.text&&function(t){Array.from(t.children).sort(((e,n)=>+e.getAttribute("data-sort")<n.getAttribute("data-sort")?t.insertBefore(e,n):-1))}(t)}))}(),g(function(t){return f(t,"data-brand")}(e)),g(function(t){return f(t,"data-category")}(e)),S(),document.getElementById("filters-buttons__reset").addEventListener("click",(t=>{t&&location.reload()}))}))})();
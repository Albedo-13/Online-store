(()=>{"use strict";function t(t,e,c,r){const a=document.querySelector(t),o=document.querySelector(c),n=JSON.parse(localStorage.getItem("RS-online-cart"));a.textContent=e+n.reduce(((t,e)=>t+e.count),0),o.textContent=r+n.reduce(((t,e)=>t+e.count*e.price),0)}let e=document.querySelector(".products-list");function c(){e.innerHTML='\n  <div class="cart-empty">YOUR üõí IS EMPTY :)</div>\n  '}let r,a=document.querySelector(".products-list");localStorage.getItem("RS-online-cart")||localStorage.setItem("RS-online-cart",JSON.stringify([])),JSON.parse(localStorage.getItem("RS-online-cart")).length||c(),async function(){let t=await fetch("https://dummyjson.com/products");return(await t.json()).products}().then((o=>{r=JSON.parse(JSON.stringify(o)),JSON.parse(localStorage.getItem("RS-online-cart")).forEach((t=>{r.find((e=>e.id===t.id))&&function(t){let c=document.createElement("div");c.className="products-item",c.id=`cart-item-${t.id}`,c.innerHTML=`\n    <div class="products-item__image">\n      <img src="${t.thumbnail}" alt="product image">\n    </div>\n    <div class="products-item__about">\n      <div class="products-item__name">${t.title}</div>\n      <div class="products-item__rating">Rating: ${t.rating}‚≠ê</div>\n      <div class="products-item__discount">Discount: ${t.discountPercentage}%</div>\n    </div>\n    <div class="products-item__scale">\n      <div class="products-item__stock">Stock: ${t.stock}üõç</div>\n      <button class="products-item__add" id=product-increase-${t.id}>+</button>\n      <div class="products-item__count" id=product-counter-${t.id}>1</div>\n      <button class="products-item__remove" id=product-decrease-${t.id}>-</button>\n      <div class="products-item__price">Price per item: ${t.price}ÔºÑ</div>\n      <button class="products-item__delete" id=product-delete-${t.id}>X</button>\n    </div>`,e.appendChild(c)}(r.find((e=>e.id===t.id)))})),JSON.parse(localStorage.getItem("RS-online-cart")).forEach((t=>{document.querySelector(`#product-counter-${t.id}`).textContent=t.count})),t(".summary__total-products","Total products: ",".summary__total-price","Total price: ÔºÑ"),t(".header__cart span","",".header__total","Cart total:ÔºÑ"),function(){const t=document.querySelector(".summary__buy"),e=document.querySelector(".modal"),c=e.querySelector(".modal-form"),r=e.querySelector(".modal__close"),a=e.querySelector(".card-number__number"),o=e.querySelector(".card-number__valid"),n=e.querySelector(".card-number__cvv");t.addEventListener("click",(()=>{JSON.parse(localStorage.getItem("RS-online-cart")).length>0&&e.classList.remove("hide")})),r.addEventListener("click",(()=>{e.classList.add("hide")})),e.addEventListener("click",(t=>{t.target===e&&e.classList.add("hide")})),a.addEventListener("keydown",(t=>{"Backspace"!==t.key&&"Delete"!==t.key||(t.target.value="")})),a.addEventListener("input",(t=>{if(function(t){const e=["https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSkdMZcTxIgmkIGjBHvY_maSuIOIWH79cHpn2LbnYT47YrYxrmCnumq4EEEyQ0sy_ZSSUY&usqp=CAU","https://cdn-icons-png.flaticon.com/512/349/349221.png","https://upload.wikimedia.org/wikipedia/commons/thumb/2/2a/Mastercard-logo.svg/989px-Mastercard-logo.svg.png"];"4"===t[0]?document.querySelector(".card-number__image").setAttribute("src",e[1]):"5"===t[0]?document.querySelector(".card-number__image").setAttribute("src",e[2]):document.querySelector(".card-number__image").setAttribute("src",e[0])}(t.target.value),/^[0-9\s]*$/.test(t.target.value)){if(+t.target.value.length>4){const e=t.target.value.split(" ").join(""),c=e.slice(0,4)+" "+e.slice(4,8)+" "+e.slice(8,12)+" "+e.slice(12,16);t.target.value=c.slice(0,19)}}else t.target.value=""})),o.addEventListener("input",(t=>{if(console.log(+t.target.value.length),console.log(+t.target.getAttribute("max")),/^[0-9/]*$/.test(t.target.value)){if(+t.target.value.length>=2){+t.target.value.split("/")[0]>12&&(t.target.value="12");const e=t.target.value.split("/").join(""),c=e.slice(0,2)+"/"+e.slice(2,4);t.target.value=c.slice(0,5)}}else t.target.value=""})),o.addEventListener("keydown",(t=>{"Backspace"!==t.key&&"Delete"!==t.key||(t.target.value="")})),n.addEventListener("input",(t=>{if(console.log(+t.target.value.length),console.log(+t.target.getAttribute("max")),+t.target.value.length>2){const e=t.target.value;t.target.value=e.slice(0,3)}})),c.addEventListener("submit",(()=>{localStorage.setItem("RS-online-cart",[])}))}(),function(e,r){function a(t){document.querySelector(`#cart-item-${t}`).remove()}e.addEventListener("click",(e=>{const o=+e.target.id.split("-")[2];let n=JSON.parse(localStorage.getItem("RS-online-cart"));e.target.classList.contains("products-item__add")&&n.forEach((t=>{t.id===o&&t.count<r.find((t=>t.id===o)).stock&&(++t.count,document.querySelector(`#product-counter-${o}`).textContent=t.count)})),e.target.classList.contains("products-item__remove")&&n.forEach((t=>{t.id===o&&(--t.count,t.count<=0?(n=n.filter((t=>t.id!==o)),a(o)):document.querySelector(`#product-counter-${o}`).textContent=t.count)})),e.target.classList.contains("products-item__delete")&&(n=n.filter((t=>t.id!==o)),a(o)),n.length||c(),localStorage.setItem("RS-online-cart",JSON.stringify(n)),t(".header__cart span","",".header__total","Cart total:ÔºÑ"),t(".summary__total-products","Total products: ",".summary__total-price","Total price: ÔºÑ")}))}(a,r)}))})();